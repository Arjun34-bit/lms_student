import{c as I,b as h,u as y,y as V,F as B,a as C}from"./index.esm.B1fCZ8yi.js";import{s as v,g as E}from"./localStorageUtils.BuRq4_r3.js";import{g as F,u as P}from"./authQueries.BcGoVAi4.js";import{_ as D}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{c as p,a as l,b as w,w as N,r as i,h as S,o as g,d as k,F as j,g as L,t as c,m as O}from"./runtime-core.esm-bundler.Vqe_tuZK.js";import"./_commonjsHelpers.D6-XlEtG.js";import"./client.D6J25A0q.js";const q={__name:"Profile",setup(M,{expose:u}){u();const n=i(!1),e=i(""),d=i(""),b=[{name:"name",label:"Full Name"},{name:"email",label:"Email Address"},{name:"phoneNumber",label:"Phone Number"}],s=I({name:h(),email:h(),phoneNumber:h()}),r=i({name:"",email:"",phoneNumber:""}),{setFieldValue:m,values:U}=y({validationSchema:s}),_=async()=>{try{const t=(await F())?.data;v("user",t),t&&b.forEach(({name:a})=>{r.value[a]=t[a]||"",m(a,t[a]||"")})}catch(o){console.error("Failed to fetch user profile:",o)}};S(async()=>{await _()});const x={loading:n,successMessage:e,errorMessage:d,editableFields:b,schema:s,originalValues:r,setFieldValue:m,values:U,fetchUserProfile:_,onSubmit:async o=>{e.value="",d.value="",n.value=!0;try{let t=!1;const a={};for(const f in o)a[f]=o[f],o[f]!==r.value[f]&&(t=!0);if(!t){e.value="No changes to update.",n.value=!1;return}const A={...r.value,...a};r.value=A,await P(a),e.value="Profile updated successfully!",await _()}catch(t){d.value=t?.response?.data?.message||"Failed to update profile."}finally{n.value=!1}},ref:i,onMounted:S,get Form(){return C},get Field(){return B},get useForm(){return y},get yup(){return V},get getItem(){return E},get setItem(){return v},get getUserProfileApi(){return F},get updateUserProfileApi(){return P}};return Object.defineProperty(x,"__isScriptSetup",{enumerable:!1,value:!0}),x}},z={class:"max-w-2xl mx-auto mt-10 p-6 bg-white rounded-2xl shadow-lg space-y-6"},G={class:"text-sm font-semibold text-gray-600 block mb-1"},H=["placeholder"],J={class:"text-red-500 text-sm mt-1"},K={key:0,class:"text-green-600 text-sm text-center"},Q={key:1,class:"text-red-600 text-sm text-center"},R={type:"submit",class:"w-full p-3 bg-blue-600 text-white font-semibold rounded-xl hover:bg-blue-700"};function T(M,u,n,e,d,b){return g(),p("div",z,[u[0]||(u[0]=l("h2",{class:"text-2xl font-bold text-gray-800 border-b pb-4"}," Student Profile ",-1)),w(e.Form,{onSubmit:e.onSubmit,"validation-schema":e.schema},{default:N(()=>[(g(),p(j,null,L(e.editableFields,s=>l("div",{key:s.name,class:"mb-6"},[l("label",G,c(s.label),1),w(e.Field,{name:s.name},{default:N(({field:r,errors:m})=>[l("input",O({ref_for:!0},r,{placeholder:e.originalValues[s.name]||"â€”",class:"w-full px-3 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500"}),null,16,H),l("p",J,c(m[0]),1)]),_:2},1032,["name"])])),64)),e.successMessage?(g(),p("div",K,c(e.successMessage),1)):k("",!0),e.errorMessage?(g(),p("div",Q,c(e.errorMessage),1)):k("",!0),l("button",R,c(e.loading?"Updating...":"Update"),1)]),_:1},8,["validation-schema"])])}const se=D(q,[["render",T]]);export{se as default};
